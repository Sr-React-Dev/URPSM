{% extends "two_factor/_base_focus.html" %}
{% load i18n %}

{% block content %}


<section class="content">
    <div class="row">
      <div class="col-md-12">
        <div class="box box-primary">
          <div class="box-header with-border">
            <h3 class="box-title">{% block title %}{% trans "Enable Two-Factor Authentication" %}{% endblock %}</h3>
          </div>
          <div class="box-body">
            {% if wizard.steps.current == 'welcome' %}
              <p>{% blocktrans %}You are about to take your account security to the
                  next level. Follow the steps in this wizard to enable two-factor
                  authentication.{% endblocktrans %}</p>
            {% elif wizard.steps.current == 'method' %}
              <p>{% blocktrans %}Please select which authentication method you would
                  like to use.{% endblocktrans %}</p>
            {% elif wizard.steps.current == 'generator' %}
              <p>{% blocktrans %}To start using a token generator, please use your
                  smartphone to scan the QR code below. For example, use Google
                  Authenticator. Then, enter the token generated by the app.
                  {% endblocktrans %}</p>
              <img src="{{ QR_URL }}" alt="QR Code" />
            {% elif wizard.steps.current == 'sms' %}
              <p>{% blocktrans %}Please enter the phone number you wish to receive the
                text messages on. This number will be validated in the next step.
                {% endblocktrans %}</p>
            {% elif wizard.steps.current == 'call' %}
              <p>{% blocktrans %}Please enter the phone number you wish to be called on.
                This number will be validated in the next step. {% endblocktrans %}</p>
            {% elif wizard.steps.current == 'validation' %}
              {% if challenge_succeeded %}
                {% if device.method == 'call' %}
                  <p>{% blocktrans %}We are calling your phone right now, please enter the
                    digits you hear.{% endblocktrans %}</p>
                {% elif device.method == 'sms' %}
                  <p>{% blocktrans %}We sent you a text message, please enter the tokens we
                    sent.{% endblocktrans %}</p>
                {% endif %}
              {% else %}
                <p class="alert alert-warning" role="alert">{% blocktrans %}We've
                  encountered an issue with the selected authentication method. Please
                  go back and verify that you entered your information correctly, try
                  again, or use a different authentication method instead. If the issue
                  persists, contact the site administrator.{% endblocktrans %}</p>
              {% endif %}
            {% elif wizard.steps.current == 'yubikey' %}
              <p>{% blocktrans %}To identify and verify your YubiKey, please insert a
                token in the field below. Your YubiKey will be linked to your
                account.{% endblocktrans %}</p>
            {% endif %}
          </div>
          <form action="" method="post" class="twof-form">{% csrf_token %}
            {% include "two_factor/_wizard_forms.html" %}
            <div class="box-footer">
                {# hidden submit button to enable [enter] key #}
                <input type="submit" class="hidden-submit"/>
                {% include "two_factor/_wizard_actions_dashbord.html" %}
            </div>
          </form>
        </div>
      </div>
    </div>
</section>




{% endblock %}
